Xyz_D=  1.00000000E-01  2.00000000E-01  3.00000000E-01
Sph_D=  3.74165739E-01  6.40522313E-01  1.10714872E+00
Xyz_D=  1.00000000E-01  2.00000000E-01  3.00000000E-01
rLonLat_D=  3.74165739E-01  1.10714872E+00  9.30274014E-01
Xyz_D=  1.00000000E-01  2.00000000E-01  3.00000000E-01
rot_matrix_z(-Phi)=

  0.4472135955  0.8944271910  0.0000000000
 -0.8944271910  0.4472135955  0.0000000000
  0.0000000000  0.0000000000  1.0000000000

rot_matrix_z(-Phi).Xyz_D=  2.23606798E-01  2.77555756E-17  3.00000000E-01
Xyz_D.rot_matrix_y(Theta)=  2.77555756E-17  2.77555756E-17  3.74165739E-01
Original Xyz=  1.00000000E-03 -4.00000000E-01  3.53530000E-01
Rotated  Xyz=  1.00000000E-03 -4.00000000E-01  3.53530000E-01

Cartesian position=  8.00000000E+00  1.00000000E-01  6.00000000E+00
XyzSph_DD
  0.7999600030  0.5999231351 -0.0124990236
  0.0099995000  0.0074990392  0.9999218842
  0.5999700022 -0.8000224974  0.0000000000

Spherical vector  =  1.00000000E+00  0.00000000E+00  0.00000000E+00
Cartesian vector  =  7.99960003E-01  9.99950004E-03  5.99970002E-01
Spherical vector  =  0.00000000E+00  1.00000000E+00  0.00000000E+00
Cartesian vector  =  5.99923135E-01  7.49903919E-03 -8.00022497E-01
Spherical vector  =  0.00000000E+00  0.00000000E+00  1.00000000E+00
Cartesian vector  = -1.24990236E-02  9.99921884E-01  0.00000000E+00

Check inversion: write the inverse of XyzSph_DD:
  0.7999600030  0.0099995000  0.5999700022
  0.5999231351  0.0074990392 -0.8000224974
 -0.0124990236  0.9999218842 -0.0000000000

For comparison: write the transposed XyzSph_DD:
  0.7999600030  0.0099995000  0.5999700022
  0.5999231351  0.0074990392 -0.8000224974
 -0.0124990236  0.9999218842  0.0000000000


Check inversion: 5 x 5 matrix A:
  3.0000000000 16.0000000000 14.0000000000 13.0000000000  9.0000000000
  7.0000000000  8.0000000000  6.0000000000 19.0000000000 21.0000000000
  5.0000000000 17.0000000000 35.0000000000  4.0000000000  1.0000000000
 21.0000000000 53.0000000000 18.0000000000 22.0000000000 23.0000000000
  8.0000000000  7.0000000000  1.0000000000 11.0000000000 12.0000000000

Check inversion: the inverse matrix AInv:
 -0.0252962697 -0.1276434967  0.0349634679 -0.0213355847  0.2803279030
  0.0066445702  0.0117934607 -0.0189695965  0.0325922683 -0.0865096985
 -0.0210124762  0.0262343266  0.0364591476 -0.0065976674 -0.0205434477
  0.2381257622 -0.1804873727 -0.0366884504 -0.0688325360  0.2722449788
 -0.2035427285  0.2414767101  0.0183494366  0.0588578635 -0.3009338878

Check inversion: the matrix product, A.AInv = diag{1}:
  1.0000000000  0.0000000000  0.0000000000  0.0000000000  0.0000000000
 -0.0000000000  1.0000000000  0.0000000000 -0.0000000000  0.0000000000
  0.0000000000 -0.0000000000  1.0000000000  0.0000000000  0.0000000000
  0.0000000000 -0.0000000000  0.0000000000  1.0000000000  0.0000000000
  0.0000000000  0.0000000000  0.0000000000  0.0000000000  1.0000000000


Cartesian position=  8.00000000E+00  1.00000000E-01  6.00000000E+00
XyzRlonlat_DD
  0.7999600030 -0.0124990236 -0.5999231351
  0.0099995000  0.9999218842 -0.0074990392
  0.5999700022  0.0000000000  0.8000224974

Rlonlat vector  =  1.00000000E+00  0.00000000E+00  0.00000000E+00
Cartesian vector  =  7.99960003E-01  9.99950004E-03  5.99970002E-01
Rlonlat vector  =  0.00000000E+00  0.00000000E+00 -1.00000000E+00
Cartesian vector  =  5.99923135E-01  7.49903919E-03 -8.00022497E-01
Rlonlat vector  =  0.00000000E+00  1.00000000E+00  0.00000000E+00
Cartesian vector  = -1.24990236E-02  9.99921884E-01  0.00000000E+00

Check inversion: write the inverse of XyzRlonlat_DD:
  0.7999600030  0.0099995000  0.5999700022
 -0.0124990236  0.9999218842 -0.0000000000
 -0.5999231351 -0.0074990392  0.8000224974

For comparison: write the transposed XyzRlonlat_DD:
  0.7999600030  0.0099995000  0.5999700022
 -0.0124990236  0.9999218842  0.0000000000
 -0.5999231351 -0.0074990392  0.8000224974


Cartesian position=  8.00000000E+00  1.00000000E-01  6.00000000E+00
XyzMercator_DD
 -0.0124990236 -0.5999231351  0.7999600030
  0.9999218842 -0.0074990392  0.0099995000
  0.0000000000  0.8000224974  0.5999700022

Same, but calculated as a product of two rotation matrices:
 -0.0124990236 -0.5999231351  0.7999600030
  0.9999218842 -0.0074990392  0.0099995000
  0.0000000000  0.8000224974  0.5999700022

